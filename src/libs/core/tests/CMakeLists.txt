########################################################################################################################
#
# Library: OpenCTK
#
# Copyright (C) 2025~Present ChengXueWen.
#
# License: MIT License
#
# Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated
# documentation files (the "Software"), to deal in the Software without restriction, including without limitation
# the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and
# to permit persons to whom the Software is furnished to do so, subject to the following conditions:
#
# The above copyright notice and this permission notice shall be included in all copies or substantial portions
# of the Software.
#
# THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE
# WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE  AUTHORS
# OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR
# OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
#
########################################################################################################################

#-----------------------------------------------------------------------------------------------------------------------
# Set tests output path
#-----------------------------------------------------------------------------------------------------------------------
set(OCTK_TEST_OUTPUT_DIR ${OCTK_BUILD_DIR}/${OCTK_INSTALL_TESTSDIR})


#-----------------------------------------------------------------------------------------------------------------------
# Add tests link libraries
#-----------------------------------------------------------------------------------------------------------------------
octk_find_package(WrapAbseil PROVIDED_TARGETS OCTK3rdparty::WrapAbseil)
set(OCTK_TEST_LINK_LIBRARIES octk::core OCTK3rdparty::WrapGTest OCTK3rdparty::WrapBenchmark)


#-----------------------------------------------------------------------------------------------------------------------
# Add tests
#-----------------------------------------------------------------------------------------------------------------------
octk_add_test(octk_core_tst_aligned_malloc
	SOURCES
	tst_aligned_malloc.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_array_view
	SOURCES
	tst_array_view.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_base64
	SOURCES
	tst_base64.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_buffer
	SOURCES
	tst_buffer.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_checks
	SOURCES
	tst_checks.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_clock
	SOURCES
	tst_clock.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_crypto_random
	SOURCES
	tst_crypto_random.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_ctordtor
	SOURCES
	tst_ctordtor.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_data_rate
	SOURCES
	tst_data_rate.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_data_size
	SOURCES
	tst_data_size.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_date_time
	SOURCES
	tst_date_time.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_divide_round
	SOURCES
	tst_divide_round.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_elapsed_timer
	SOURCES
	tst_elapsed_timer.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_error
	SOURCES
	tst_error.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_exception
	SOURCES
	tst_exception.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_fake_clock
	SOURCES
	tst_fake_clock.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
#octk_add_test(octk_core_tst_file_utils
#	SOURCES
#	tst_file_utils.cpp
#	INCLUDE_DIRECTORIES
#	LIBRARIES
#	${OCTK_TEST_LINK_LIBRARIES}
#	OUTPUT_DIRECTORY
#	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_filesystem
	SOURCES
	tst_filesystem.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_frequency
	SOURCES
	tst_frequency.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_function_view
	SOURCES
	tst_function_view.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_inlined_vector
	SOURCES
	${OCTKWrapAbseil_SOURCE_DIR}/absl/container/internal/test_instance_tracker.cc
	tst_inlined_vector.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	OCTK3rdparty::WrapAbseil
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_metrics
	SOURCES
	tst_metrics.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_move_wrapper
	SOURCES
	tst_move_wrapper.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_mutex
	SOURCES
	tst_mutex.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_mutex_benchmark
	SOURCES
	tst_mutex_benchmark.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_ntp_time
	SOURCES
	tst_ntp_time.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_numeric
	SOURCES
	tst_numeric.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_pending_task_safety_flag
	SOURCES
	tst_pending_task_safety_flag.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_platform_thread
	SOURCES
	tst_platform_thread.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_random
	SOURCES
	tst_random.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_ref_counted_object
	SOURCES
	tst_ref_counted_object.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_repeating_task
	SOURCES
	tst_repeating_task.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_scope_guard
	SOURCES
	tst_scope_guard.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_scoped_refptr
	SOURCES
	tst_scoped_refptr.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_sequence_checker
	SOURCES
	tst_sequence_checker.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_shared_buffer
	SOURCES
	tst_shared_buffer.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_shared_data
	SOURCES
	tst_shared_data.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_signals
	SOURCES
	tst_signals.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_source_location
	SOURCES
	tst_source_location.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_status
	SOURCES
	tst_status.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_string_encode
	SOURCES
	tst_string_encode.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_string_to_number
	SOURCES
	tst_string_to_number.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_string_utils
	SOURCES
	tst_string_utils.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_strong_alias
	SOURCES
	tst_strong_alias.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_task_event
	SOURCES
	tst_task_event.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_task_queue
	SOURCES
	tst_task_queue.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_task_thread
	SOURCES
	tst_task_thread.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_thread_pool
	SOURCES
	tst_thread_pool.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_time_delta
	SOURCES
	tst_time_delta.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_timestamp
	SOURCES
	tst_timestamp.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_type_traits
	SOURCES
	tst_type_traits.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_unique_function
	SOURCES
	tst_unique_function.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_unit_base
	SOURCES
	tst_unit_base.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})
#octk_add_test(octk_core_tst_yield_policy
#	SOURCES
#	tst_yield_policy.cpp
#	INCLUDE_DIRECTORIES
#	LIBRARIES
#	${OCTK_TEST_LINK_LIBRARIES}
#	OUTPUT_DIRECTORY
#	${OCTK_TEST_OUTPUT_DIR})
octk_add_test(octk_core_tst_zero_memory
	SOURCES
	tst_zero_memory.cpp
	INCLUDE_DIRECTORIES
	LIBRARIES
	${OCTK_TEST_LINK_LIBRARIES}
	OUTPUT_DIRECTORY
	${OCTK_TEST_OUTPUT_DIR})